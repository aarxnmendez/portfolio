---
import Icons from "@/components/ui/Icons.astro";

interface Props {
  lang: "en" | "es";
}

const { lang } = Astro.props;

const content =
  lang === "en"
    ? (await import("@/data/en/experience")).experienceContent
    : (await import("@/data/es/experience")).experienceContent;
---

<!-- Experience Section -->
<article id="experience" class="flex flex-col gap-5 pl-2 md:pl-0">
  <h2 class="text-center lg:text-left">
    {content.title}<br /><span class="opacity-15">{content.subtitle}</span>
  </h2>
  <div
    class="relative flex flex-col gap-12 md:gap-20 mt-6 pt-8 max-w-lg md:max-w-none mx-auto md:mx-0"
  >
    <!-- Timeline Line -->
    <div
      class="absolute left-0 md:left-1/2 top-0 bottom-4 w-0.5 bg-surface/20 md:-translate-x-1/2"
      aria-hidden="true"
    >
    </div>

    {
      content.experiences.map((experience) => {
        const isRight = experience.position === "right";
        return (
          <div class="relative md:grid md:grid-cols-2 md:gap-12 md:items-start group">
            {isRight ? (
              <>
                <div class="hidden md:flex flex-col items-end pr-4">
                  <p class="!text-sm">{experience.period}</p>
                </div>
                <a
                  href={experience.url}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="group/cta flex flex-col gap-2 md:gap-3 bg-none hover:bg-surface/5 rounded-2xl pl-6 py-4 md:pl-4 md:py-0 lg:px-4 lg:!py-4 lg:-translate-y-4 transition-colors duration-300 ease-in-out"
                >
                  <div class="flex flex-row justify-between items-center w-full">
                    <h3 class="flex items-center gap-2">
                      <span aria-hidden="true" class="inline-flex">
                        <Icons name="experience" size={20} />
                      </span>
                      {experience.company}
                    </h3>
                    <span class="lg:hidden">
                      <Icons
                        name="arrow-right"
                        size={20}
                        color="var(--color-primary)"
                        class="transform -rotate-45"
                      />
                    </span>
                  </div>
                  <p class="text-left">{experience.description}</p>
                  <p class="!text-sm md:hidden">{experience.period}</p>
                </a>
              </>
            ) : (
              <>
                <a
                  href={experience.url}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="group/cta flex flex-col gap-2 md:gap-3 bg-none hover:bg-surface/5 rounded-2xl pl-6 py-4 md:pl-0 md:pr-4 md:py-0 lg:px-4 lg:!py-4 lg:-translate-y-4 transition-colors duration-300 ease-in-out"
                >
                  <div class="flex flex-row justify-between items-center w-full">
                    <h3 class="flex items-center gap-2 md:justify-end md:text-right md:w-full">
                      <span aria-hidden="true" class="inline-flex md:order-2">
                        <Icons name="experience" size={20} />
                      </span>
                      {experience.company}
                    </h3>
                    <span class="lg:hidden">
                      <Icons
                        name="arrow-right"
                        size={20}
                        color="var(--color-primary)"
                        class="transform -rotate-45"
                      />
                    </span>
                  </div>
                  <p class="text-left md:text-right">
                    {experience.description}
                  </p>
                  <p class="!text-sm md:hidden">{experience.period}</p>
                </a>
                <div class="hidden md:flex flex-col items-start pl-4">
                  <p class="!text-sm">{experience.period}</p>
                </div>
              </>
            )}
            <div
              class="absolute -left-[4.5px] md:left-1/2 top-5 md:top-1 w-3 h-3 rounded-full bg-primary ring-4 ring-background md:-translate-x-1/2 transition-transform duration-300 group-hover:scale-125"
              aria-hidden="true"
            />
          </div>
        );
      })
    }
  </div>
</article>
